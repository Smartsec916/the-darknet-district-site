
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BYTE BAZAAR — Shop 2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    html,body{margin:0;background:#000;color:#cfd6df;font-family:monospace;height:100%}
    .wrap{display:grid;place-items:center;height:100%;background:#000 url('./assets/shop_addmen.png') center/cover no-repeat;}
    .panel{background:rgba(0,0,0,.75); border:1px solid #3a5; padding:12px; width:min(720px,96vw)}
    h1{color:#9cff7e;margin:6px 0 10px 0;font-size:16px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
    .card{border:1px solid #264; padding:8px}
    .btn{display:inline-block;margin-top:6px;padding:6px 10px;border:1px solid #5c5c5c;border-radius:4px;color:#9cff7e;text-decoration:none;cursor:pointer}
    .btn:hover{filter:brightness(1.2)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <h1>BYTE BAZAAR — Add-Men</h1>
      <p>"Welcome back! New stock just came in."</p>
      <div id="stats"></div>
      <div class="grid">
        <div class="card">
          <div><b>Mobile EMP</b> — 5 BTC</div>
          <div>Disables robots, knocks drones out. +2 charges.</div>
          <button class="btn" id="buyEMP">Buy</button>
        </div>
        <div class="card">
          <div><b>BTC Magnet</b> — 10 BTC</div>
          <div>Passively pulls nearby BTC to you.</div>
          <button class="btn" id="buyMagnet">Buy</button>
        </div>
        <div class="card" style="opacity:.5">More soon…</div>
      </div>
      <div style="margin-top:10px">
        <a class="btn" id="continue">[ CONTINUE ]</a>
      </div>
    </div>
  </div>

  <script type="module">
    import { getRunN, setRunN, getRunO, setRunO, goTo } from './engine.js';

    const stats = document.getElementById('stats');
    function refresh(){
      const btc = getRunN('playerBTC',0);
      const u = getRunO('playerUpgrades',{});
      const charges = u.mobileEMP|0;
      stats.textContent = `BTC: ${btc}  |  EMP Charges: ${charges}  |  Magnet: ${u.coinMagnet?'YES':'NO'}`;
    }
    refresh();

    document.getElementById('buyEMP').onclick = ()=>{
      let btc=getRunN('playerBTC',0);
      if(btc>=5){
        btc-=5; setRunN('playerBTC',btc);
        const u=getRunO('playerUpgrades',{});
        u.mobileEMPOwned=true;
        u.mobileEMP=(u.mobileEMP|0)+2;
        setRunO('playerUpgrades',u);
        refresh();
      } else alert('Not enough BTC.');
    };

    document.getElementById('buyMagnet').onclick = ()=>{
      let btc=getRunN('playerBTC',0);
      const u=getRunO('playerUpgrades',{});
      if(u.coinMagnet){ alert('Already owned.'); return }
      if(btc>=10){
        btc-=10; setRunN('playerBTC',btc);
        u.coinMagnet=true;
        setRunO('playerUpgrades',u);
        refresh();
      } else alert('Not enough BTC.');
    };

    document.getElementById('continue').onclick=()=>{
      setRunN('gameLevel', 3);
      goTo('./level3.html');
    };
  </script>
</body>
</html>
